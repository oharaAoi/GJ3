#include "GameCore.h"

GameCore::GameCore(){}
GameCore::~GameCore(){}


//////////////////////////////////////////////////////////////////////////////////////////////////
// ↓　終了処理
//////////////////////////////////////////////////////////////////////////////////////////////////

void GameCore::Finalize(){
	sceneManger_->Finalize();
	AoiFramework::Finalize();
}


//////////////////////////////////////////////////////////////////////////////////////////////////
// ↓　初期化処理
//////////////////////////////////////////////////////////////////////////////////////////////////
void GameCore::Init(){
	AoiFramework::Init();

	sceneManger_ = std::make_unique<SceneManager>();
	sceneManger_->Init();
	sceneManger_->SetChange(SceneType::STAGE_SELECT);

	isReset_ = false;
}

//////////////////////////////////////////////////////////////////////////////////////////////////
// ↓　更新処理
//////////////////////////////////////////////////////////////////////////////////////////////////

void GameCore::Update(){
	AoiFramework::Update();
	if(sceneManger_->CheckReset()){
		isReset_ = true;
		return;
	}

	sceneManger_->Update();
#ifdef _DEBUG
	sceneManger_->Debug_Gui();
#endif
	Render::Update();
}

//////////////////////////////////////////////////////////////////////////////////////////////////
// ↓　描画処理
//////////////////////////////////////////////////////////////////////////////////////////////////

void GameCore::Draw(){
	if(isReset_){
		Engine::EndFrame();
		sceneManger_->Free();
		isReset_ = false;
		return;
	}
	sceneManger_->Draw();

	Engine::EndFrame();
	// fpsの計算
	gameTimer_.CalculationFrame();
}

//////////////////////////////////////////////////////////////////////////////////////////////////
// ↓　Debug処理
//////////////////////////////////////////////////////////////////////////////////////////////////

void GameCore::Debug_Gui(){
	sceneManger_->Debug_Gui();
}